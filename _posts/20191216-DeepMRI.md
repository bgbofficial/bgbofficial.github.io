# 0. Overview

- image-domain learning, *e.g.*, [Exploiting DCNN, 2016](http://dev.ismrm.org//2016/1778.html)    [Deep artifact learning for CS, 2017](http://arxiv.org/abs/1703.01120 )

- data-domain or k-space learning

  *e.g*., [RAKI, 2019](https://doi.org/10.1002/mrm.27420)    [K-space deep learning, 2018](https://arxiv.org/abs/1805.03779)

- transform learning (direct from k-space to image)

  *e.g*., [AUTOMAP, 2018](https://doi.org/10.1038/nature25988)

- hybrid-domain learning (unrolled loop, e.g., variational network)  

  alternate between denoising/dealiasing and reconstruction from k-space
  *e.g*., [Deep ADMM-net, 2016](https://papers.nips.cc/paper/6406-deep-admm-net-for-compressive-sensing-mri)    [variational network, 2018](https://onlinelibrary.wiley.com/doi/abs/10.1002/mrm.26977)    [DC-CNN DMRI, 2017](https://doi.org/10.1109/tmi.2017.2760978)    [cycleGAN, 2018](https://doi.org/10.1109/TMI.2018.2820120)    [mag and phase networks, 2018](https://doi.org/10.1109/TBME.2018.2821699)    [ME-CNN, 2019](https://link.springer.com/content/pdf/10.1007%2F978-3-030-32251-9_77.pdf)

# *1. Image-domain learning

![1](https://wzwimg-1300620626.cos.ap-chengdu.myqcloud.com/githubimg/clipboard_20191216043852.png)

ğŸ‘ğŸ½: ç®€å•ã€å¿«

ğŸ‘ğŸ½: ç©ºåŸŸå¾ˆå¤šæ¬ é‡‡æ ·å™ªå£°

# 2. Data-domain or k-space learning (RAKI)

![2](https://wzwimg-1300620626.cos.ap-chengdu.myqcloud.com/githubimg/clipboard_20191216044220.png)

ğŸ‘ğŸ½: ç®€å•ã€å¿« (â€œè¿˜æœ‰éçº¿æ€§çš„ GRAPPAâ€)  

ğŸ‘ğŸ½: æ›´å°‘çš„æ•°æ®ï¼šä»è‡ªåŠ¨æ ¡æ­£çš„æ•°æ®ä¸­å­¦ä¹ 

ğŸ‘ğŸ½: æ›´éš¾ä»¥è¡¨ç¤ºå±€éƒ¨å›¾åƒç‰¹å¾

## 2.1 RAKI æ¡†æ¶å’ŒLoss

RAKI (robust artificialâ€neuralâ€networks for kâ€space interpolation)

![2](https://onlinelibrary.wiley.com/cms/attachment/bd02b40d-0cd3-41d7-9517-608d2023500b/mrm27420-fig-0001-m.jpg)

![1](https://onlinelibrary.wiley.com/cms/attachment/aeca94af-a0e4-44a4-b357-ca00ece5166e/mrm27420-math-0025.png)

## 2.2 RAKI å…¬å¼



## 2.3 RAKI ç»“æœ

è¯¥é‡å»ºæ–¹æ¡ˆä½¿ç”¨äº†ä¸€ç§ç‰¹å®šäºæ‰«æçš„æ·±åº¦å­¦ä¹ æ–¹æ³•ï¼Œä½¿ç”¨é’ˆå¯¹æœ‰é™ACSæ•°æ®è®­ç»ƒçš„å·ç§¯ç¥ç»ç½‘ç»œæ¥æ”¹è¿›åŸºäºçº¿æ€§kç©ºé—´æ’å€¼çš„æ–¹æ³•çš„é‡å»ºè´¨é‡ã€‚

**TODO**ï¼šå¤ç°RAKIçš„æœ€æ–°2019ç‰ˆã€‚

# 3. Transform learning (AUTOMAP)

![3](https://wzwimg-1300620626.cos.ap-chengdu.myqcloud.com/githubimg/clipboard_20191216044252.png)

ğŸ‘ğŸ½: çœŸæ­£æ„ä¹‰ä¸Šçš„æ•°æ®é©±åŠ¨ï¼›æ½œåœ¨åœ°é¿å…äº†æ¨¡å‹çš„éé€‚é…

ğŸ‘ğŸ½: éœ€è¦æ›´å¤§çš„å†…å­˜éœ€æ±‚

## 3.1 AUTOMAP æ¡†æ¶å’ŒLoss

automated transform by manifold approximation

![1](https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fnature25988/MediaObjects/41586_2018_Article_BFnature25988_Fig1_HTML.jpg)





## 3.2 AUTOMAP å…¬å¼





## 3.3 AUTOMAP ç»“æœ

Source code is available from the corresponding author upon reasonable request.

**TODO**ï¼šå¤ç°AUTOMAP

# 4. Hybrid-domain learning (DC-CNN)

![4](https://wzwimg-1300620626.cos.ap-chengdu.myqcloud.com/githubimg/clipboard_20191216044318.png)

ğŸ‘ğŸ½: åŸºäºæ¨¡å‹é©±åŠ¨ï¼šå¯¹kç©ºé—´æ•°æ®å’Œç©ºåŸŸå…ˆéªŒæ•°æ®ä½¿ç”¨æ¨¡å‹

ğŸ‘ğŸ½: ä¼˜åŒ–ç­–ç•¥ä¸Šæ›´åŠ å…·æœ‰å¯è§£é‡Šæ€§

ğŸ‘ğŸ½: é‡å¤è¿­ä»£å’Œåå¤çš„ FFT/iFFT ï¼Œå› æ­¤æœ‰æ›´å¤šçš„è®¡ç®—é‡

## 4.1 DC-CNN å…¬å¼

æ ¹æ®å­—å…¸å­¦ä¹ ç£å…±æŒ¯é‡å»ºï¼Œå­¦åˆ°çš„çŸ¥è¯†å­˜åœ¨å­—å…¸ $\mathbf{D}$ é‡Œï¼Œå¹¶ç»™å‡ºçº¦æŸï¼Œå¯ä»¥å¾—åˆ°ï¼ˆ1ï¼‰å¼ï¼š

$$
\begin{aligned} \begin{aligned}&\underset{\mathbf {x}, \mathbf {D}, \{\boldsymbol{\gamma }_i\} }{\text {min.}}&\sum _i \left( \Vert \mathbf {R}_i\mathbf {x} - \mathbf {D} \boldsymbol{\gamma }_i \Vert _2^2 + \nu \Vert \boldsymbol{\gamma }_i \Vert _0 \right) + \lambda \Vert \mathbf {y}- \mathbf {F}_u \mathbf {x}\Vert ^2_2 \end{aligned} \end{aligned}
$$

ï¼ˆ1ï¼‰å¼è¿™é‡Œï¼Œå¯ä»¥å°†å­—å…¸ $\mathbf{D}$ çš„å­¦ä¹ è¿‡ç¨‹ç”¨cnnå‚æ•°æ›´æ–°è¿‡ç¨‹æ¥æ›¿æ¢ï¼Œå¾—åˆ°ï¼ˆ2ï¼‰å¼ï¼š

$$
\begin{aligned} \begin{aligned}&\underset{\mathbf {x}, \boldsymbol{\theta }}{\text {min.}}&\Vert \mathbf {x}- f_{\text {cnn}}(\mathbf {x}_u | \boldsymbol{\theta }) \Vert ^2_2 + \lambda \Vert \mathbf {F}_u \mathbf {x}- \mathbf {y}\Vert _2^2 \\ 
\end{aligned} \end{aligned} \tag{2}
$$

æ ¹æ® [DL-MRI, 2011](https://doi.org/10.1109/TMI.2010.2090538) ï¼Œå¯ä»¥å¾—åˆ°ï¼ˆ2ï¼‰å¼çš„åœ¨kç©ºé—´çš„è§£æè§£ï¼š

$$
\begin{aligned}\hat{\mathbf {x}}_{\text {rec}}(k) = {\left\{ \begin{array}{ll} \hat{\mathbf {x}}_{\text {cnn}}(k) &{} \text {if } k \not \in \varOmega \\ \frac{\hat{\mathbf {x}}_{\text {cnn}}(k) + \lambda \hat{\mathbf {x}}_u(k)}{1+\lambda } &{} \text {if } k \in \varOmega \end{array}\right. } \end{aligned} \tag{3}
$$

å…¶ä¸­ï¼Œ$\hat{\mathbf {x}}_{\text {cnn}} = \mathbf {F} f_{\text {cnn}}(\mathbf {x}_u | \boldsymbol {\theta })$ , $\hat{\mathbf {x}}_u = \mathbf {F}\mathbf {x}_u$ ï¼Œè¿™é‡Œçš„ $\mathbf {F}$ æ˜¯å‚…é‡Œå¶ç¼–ç çŸ©é˜µã€‚

æŠŠï¼ˆ3ï¼‰å¼å­ç”¨pythonä»£ç å†™ä¸‹æ¥ï¼š

```python
# noisy case
out = (x_cnn + lambda * kspace_samples) / (1 + lambda)
# noiseless case
out = (1 - mask) * x + kspace_samples
```

## 4.2 DC-CNN 

Input: æ¬ é‡‡æ ·çš„å¤æ•°ç©ºåŸŸ $\mathbf{x}_u$ï¼›(è®­ç»ƒè¿˜ä½¿ç”¨äº†  æ¬ é‡‡æ ·çš„kç©ºé—´æ•°æ® $\mathbf{k}_u$ï¼Œmaskï¼Œå…¨é‡‡æ ·çš„å¤æ•°ç©ºåŸŸ $\mathbf{x}$** )

**output: å¤æ•°ç©ºåŸŸ**ï¼›

æ•´ä¸ªç½‘ç»œæ˜¯å åŠ çš„ï¼š

![1](https://media.springernature.com/original/springer-static/image/chp%3A10.1007%2F978-3-319-59050-9_51/MediaObjects/450577_1_En_51_Fig1_HTML.gif)

ä¸€ä¸ªç»„ä»¶åŒ…å«äº†ï¼ˆInput â†’ CNN1 â†’ DC â†’ Outputï¼‰ï¼Œå…¶æ­£å‘è®­ç»ƒçš„ç½‘ç»œç»“æ„æ˜¯ï¼š

**CNNå±‚**ï¼š

$\mathbf{x}_u$è¾“å…¥ï¼šï¼ˆç©ºåŸŸæ¬ é‡‡æ ·æ•°æ®ã€ç©ºåŸŸå…¨é‡‡æ ·æ•°æ®ã€kç©ºé—´æ¬ é‡‡æ ·æ•°æ®ã€æ¬ é‡‡æ ·maskï¼‰ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œè¦æŠŠä¸€ä¸ªå¤æ•°ç©ºåŸŸçŸ©é˜µè¢«åˆ†æˆä¸¤ä¸ªå®æ•°çŸ©é˜µã€‚å‡è®¾ä¸€å…±æœ‰256å¼ ç©ºåŸŸå¤æ•°å›¾ï¼Œæ¯å¼ å›¾åˆ†è¾¨ç‡æ˜¯ `(128, 128)`ï¼Œæ¯ä¸ªç‚¹éƒ½è¾“å¤æ•°ï¼Œ åˆ™è¯¥çŸ©é˜µå¯ä»¥è¡¨ç¤ºä¸º `(256, 128, 128)`ã€‚é€šè¿‡åˆ†æˆä¸¤ä¸ªå®æ•°çŸ©é˜µï¼Œåˆ™è¯¥æ•°æ®å¤šäº†ä¸€ä¸ªç»´åº¦`(256, 128, 128, 2)`ï¼›

$C_1$ï¼šç¬¬ä¸€å±‚å·ç§¯å±‚ï¼›

$C_2$~$C_{d-1}$ï¼šç¬¬äºŒå±‚å·ç§¯å±‚~ç¬¬d-1å±‚å·ç§¯å±‚ï¼›

$C_{rec}$ï¼šæ±‡èšé‡å»ºå±‚ï¼Œæ­¤å±‚çš„è¾“å‡ºç‰¹å¾å›¾shapeä¸è¾“å…¥å±‚æ•°æ®çš„shapeä¸€è‡´ï¼›

$\mathbf{x}_{cnn}$ ï¼šCNNè¾“å‡ºå±‚ï¼Œæ­¤å±‚æ˜¯ä¸€ä¸ªæ®‹å·®ç½‘ç»œï¼Œ $\mathbf{x}_{cnn}=\mathbf{x}_u + C_{rec}$ï¼Œè¿™é‡Œçš„ + æ˜¯åšæŒ‰å…ƒç´ ç›¸åŠ ï¼Œéä¸²è”ï¼Œå…¶è¾“å‡ºshapeä¸è¾“å…¥å±‚shapeä¸€è‡´ã€‚

**DCå±‚**ï¼š

å…¶ä¼ªä»£ç å¯ä»¥è¡¨ç¤ºä¸ºï¼š

```python
# data consistency layer
dft2 = FFT2DLayer(x_cnn)
dc = DataConsistencyWithMaskLayer(dft2, mask, kspace_samples)
idft2 = FFT2DLayer(dc, inv=True)
x_rec = idft2
```

å…¶ä¸­ï¼Œ`DataConsistencyWithMaskLayer` é‡Œä¸»è¦æ˜¯ç”¨åˆ°äº†ï¼ˆ3ï¼‰å¼ è¿™æ ·çš„æ“ä½œ

```python
# noisy case
dc = (dft2 + lambda * kspace_samples) / (1 + lambda)
# noiseless case
dc = (1 - mask) * dft2 + kspace_samples
```

## 4.3 DC-CNN ç»“æœ

![1](https://wzwimg-1300620626.cos.ap-chengdu.myqcloud.com/githubimg/myplot.png)

Figure 1: a, b, c

ä½¿ç”¨DC-CNNçš„é¢„æµ‹å‡½æ•°è¿›è¡Œï¼Œéšæ„æ‰¾ä¸€ä¸ªmriå›¾åƒï¼Œé‡‡æ ·ç‡æ˜¯ 25%ã€‚

è¾“å…¥ä¸€å¼ ç©ºåŸŸå¤æ•°ï¼ˆå–ç»å¯¹å€¼åï¼Œå¦‚å›¾1ä¸­çš„bã€‚ï¼‰ï¼›å°†bå›¾ä¸­çš„å¤æ•°ç©ºåŸŸ25%é‡‡æ ·ï¼Œåˆ™é€šè¿‡ä¸€æ¬¡æ­£å‘è¿ç®—ï¼Œå¾—åˆ°å›¾1ä¸­çš„cï¼›å°†bå›¾æ€»çš„å¤æ•°ç©ºåŸŸ25%é‡‡æ ·ï¼Œç›´æ¥FFTåå¾—åˆ°aå›¾ã€‚

**æ•°æ®**ï¼šè¿™é‡Œä½¿ç”¨äº†256å¼ è†ç›–é™„è¿‘è¿ç»­åˆ‡ç‰‡(128, 128)çš„xæ–¹å‘è¿›è¡Œè®­ç»ƒï¼›è¿ç»­åˆ‡ç‰‡çš„256å¼ yæ–¹å‘ä½œä¸ºéªŒè¯é›†ï¼›åˆ‡ç‰‡çš„zæ–¹å‘ä½œä¸ºæµ‹è¯•é›†ï¼›

**æ·±åº¦å­¦ä¹ æ¡†æ¶**ï¼šç”¨çš„è¿œå¤æ¡†æ¶ `Theano`ï¼Œç›®å‰å·²åœæ­¢å¼€å‘å’Œç»´æŠ¤ã€‚

**TODO**ï¼šç”¨Pytorch é‡å†™ DC-CNN çš„æœ€æ–°ç‰ˆã€‚

**Cardiac Motion**ï¼š

<video src="https://wzwimg-1300620626.cos.ap-chengdu.myqcloud.com/githubimg/cardiac_motion.mp4" controls="controls" width='30%' height='30%' style="max-width: 100%; display: block; margin-left: auto; margin-right: auto;">
your browser does not support the video tag
</video>